/*! Innerwave Spreadsheet - v0.2.617-SNAPSHOT - 2015-02-13
* Copyright (c) 2015 innerwave.co.kr; Licensed  */
!function(a,b){function c(a){a=a.replace(/\r\n/g,"\n");for(var b,c=[],d=0,e=0,f=a.length;f>e;e++)b=a.charCodeAt(e),128>b?c[d++]=String.fromCharCode(b):b>127&&2048>b?(c[d++]=String.fromCharCode(b>>6|192),c[d++]=String.fromCharCode(63&b|128)):(c[d++]=String.fromCharCode(b>>12|224),c[d++]=String.fromCharCode(b>>6&63|128),c[d++]=String.fromCharCode(63&b|128));return c.join("")}function d(a){for(var b=[],c=0,d=0,e=0,f=0,g=a.length;g>d;)e=a.charCodeAt(d++),128>e?b[c++]=String.fromCharCode(e):e>191&&224>e?(f=a.charCodeAt(d++),b[c++]=String.fromCharCode((31&e)<<6|63&f)):(f=a.charCodeAt(d++),c3=a.charCodeAt(d++),b[c++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&c3));return b.join("")}a.extend(!0,b,{iui:{util:{}}});var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";iui.util.Base64={encode:function(a){a=c(a);for(var b,d,f,g,h,i,j,k=[],l=0,m=0,n=a.length;n>m;)b=a.charCodeAt(m++),d=a.charCodeAt(m++),f=a.charCodeAt(m++),g=b>>2,h=(3&b)<<4|d>>4,i=(15&d)<<2|f>>6,j=63&f,isNaN(d)?i=j=64:isNaN(f)&&(j=64),k[l++]=e.charAt(g),k[l++]=e.charAt(h),k[l++]=e.charAt(i),k[l++]=e.charAt(j);return k.join("")},decode:function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,f,g,h,i,j,k=[],l=0,m=0,n=a.length;n>l;)g=e.indexOf(a.charAt(l++)),h=e.indexOf(a.charAt(l++)),i=e.indexOf(a.charAt(l++)),j=e.indexOf(a.charAt(l++)),b=g<<2|h>>4,c=(15&h)<<4|i>>2,f=(3&i)<<6|j,k[m++]=String.fromCharCode(b),64!==i&&(k[m++]=String.fromCharCode(c)),64!==j&&(k[m++]=String.fromCharCode(f));return d(k.join(""))}}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.Circuit=function(b){return b=b?a.isArray(b)?b:[b]:[],this instanceof iui.util.Circuit?(this.index=0/0,this.elements=b,void(this.length=this.elements.length)):new iui.util.Circuit(b)},a.extend(iui.util.Circuit.prototype,{getIndex:function(){return this.index=(this.elements.length+this.index)%this.elements.length},prev:function(){return isNaN(parseInt(this.index))?this.index=0:(this.index--,this.index=this.getIndex()),this.elements[this.index]},now:function(){return this.elements[this.index]},next:function(){return isNaN(parseInt(this.index))?this.index=0:(this.index++,this.index=this.getIndex()),this.elements[this.index]},append:function(a){this.elements[this.length++]=a},remove:function(){this.index=this.getIndex(),this.elements.splice(this.index,1),this.length--}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}});var c=0;iui.util.Collection=function(a){return this instanceof iui.util.Collection?(this.name=a||"",this.length=0,this.items=[],this.itemByIds={},void(this.eventPrefix="collection")):new iui.util.Collection},a.extend(iui.util.Collection.prototype,{find:function(a){return this.indexOf(this.itemByIds[a])},has:function(a){return!!this.itemByIds[a.uid]},get:function(a){return this.items[a]},getById:function(b){var c=this.itemByIds[b];return c||(c=a.map(this.items,function(a){return a.id===b?a:null})[0]),c},indexOf:function(b){return a.inArray(b,this.items)},addAll:function(a){for(var b=0,c=a.length;c>b;b++)this.add(a[b]);return this},add:function(a){return a.uid=a.uid||"item"+c++,this.has(a)||(this.items.push(a),this.itemByIds[a.uid]=a,this.length++),this},insert:function(a,b){return a.uid=a.uid||"item"+c++,this.has(a)||(this.itemByIds[a.uid]=a,0>b?this.items.unshift(a):b>=this.items.length?this.items.push(a):this.items.splice(b,0,a),this.length++),this},insertBefore:function(a,b){return this.insert(a,--b)},insertAfter:function(a,b){return this.insert(a,++b)},empty:function(){this.length=0,this.items.length=0,this.items=[],this.itemByIds={}},remove:function(a){var b=this.indexOf(a);return b>=0&&(this.items.splice(b,1),this.length--),delete this.itemByIds[a.uid],this},move:function(a,b){a="string"==typeof a?this.itemByIds[a]:"number"==typeof a?this.items[a]:a;var c=this.indexOf(a),d=c+b;if(0>c)throw"can not find item";return this.items.splice(c,1),0>d?this.items.unshift(a):d>=this.length?this.items[this.length]=a:this.items.splice(d,0,a),this},each:function(a,b){var c=0,d=this.length;if("string"==typeof a)for(;d>c;c++)this.items[c][a].apply(this.items[c],b);else if(a instanceof Function)for(;d>c;c++)a.apply(this.items[c],b)},toArray:function(){return this.items},iterator:function(){return iui.util.Iterator(this.items)},toJSON:function(){return JSON.stringify(this.items)},toXML:function(){for(var b=a.parseXML("<collection></collection>"),c=0,d=this.items.length;d>c;c++)b.appendChild(this.items[c].toXML());return b}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.DoubleLinkedList=function(){return!this instanceof iui.util.DoubleLinkedList?new iui.util.DoubleLinkedList:void(this.items={})},a.extend(iui.util.DoubleLinkedList.prototype,{add:function(a){var b=iui.util.hash(a);this.items[b]=a},remove:function(){},has:function(){},first:function(){},last:function(){}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.fnv32a=function(a){for(var b=2166136261,c=b,d=0,e=a.length;e>d;d++)c^=a.charCodeAt(d),c+=(c<<1)+(c<<4)+(c<<7)+(c<<8)+(c<<24);return c>>>0},iui.util.hash=function(a){return iui.util.fnv32a(iui.util.Base64.encode(a))}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.Iterator=function(a){this.nextIndex=0,this.elements=a||[]},a.extend(iui.util.Iterator.prototype,{hasNext:function(){return this.nextIndex<this.elements.length},next:function(){return this.hasNext()?this.elements[this.nextIndex++]:void 0},remove:function(){this.hasNext()&&this.elements.splice(this.nextIndex,1)}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}});var c=(new Date).getTime();iui.util.laptime=function(a){var b=(new Date).getTime()-c;return b}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.List=function(){},a.extend(iui.util.List.prototype,{append:function(){},insert:function(){},before:function(){},after:function(){},remove:function(){}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.List=function(b){return!this instanceof iui.util.List?new iui.util.List(b):void(this.items=b?a.isArray(b)?b:[b]:[])},a.extend(iui.util.List.prototype,{add:function(){},remove:function(){},has:function(){},first:function(){},last:function(){}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{util:{}}}),iui.util.uniqueId=function(){var a=0;return function(b){return b+a++}}()}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{model:{}}}});var c=[];iui.sheet.model.Entity={parent:function(a){return a?void(this._parent=a):this._parent},hasClass:function(b){return b?(c=this.className?this.className.split(/\s+/):[],a.inArray(b,c,0)):-1},addClass:function(a){return a&&this.hasClass(a)<0&&(c.push(a),this.className=c.join(" "),this.ui&&this.ui.addClass(a)),this},removeClass:function(a){if(a){var b=this.hasClass(a);b>=0&&(c.splice(b,1),this.className=c.join(" "),this.ui&&this.ui.removeClass(a))}return this},toggleClass:function(a){return a&&(this.hasClass(a)<0?this.addClass(a):this.removeClass(a)),this},toString:function(){var a={};for(var b in this)a[b]=this[b];return JSON.stringify(a).replace(/\r\n/g,"")}}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{model:{}}}});var c=0,d=iui.sheet.model.Cell=function(a){if(a=a||{},!(this instanceof d))return new d(a);for(var b in a)this[b]=a[b];this.index=c++,this.uid=a.id||"cell"+c,this.id=a.id||this.uid,this.value=a.value,this.formula=a.formula,this.className="spreadsheet-cell "+(a.classname||""),this.renderer=a.renderer,this.editor=a.editor,this.rows=(new iui.util.Collection).addAll(a.rows||[]),this.columns=(new iui.util.Collection).addAll(a.columns||[]),this.ui=null};a.extend(d.prototype,iui.sheet.model.Entity,{getRenderer:function(){return this.renderer?this.renderer:this.columns.length>0?this.columns.get(0).renderer:iui.sheet.renderer.String}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{model:{}}}});var c=0;iui.sheet.model.Column=function(a){if(a=a||{},!(this instanceof iui.sheet.model.Column))return new iui.sheet.model.Column(a);for(var b in a)this[b]=a[b];this.index=c++,this.uid=a.id||"column"+c,this.id=a.id||this.uid,this.visualId=a.visualId,this.label=a.label,this.width=a.width||80,this.height=a.height||26,this.className="spreadsheet-column ui-state-default "+(a.className||""),this.group=a.group,this.ui=null,this._offset={left:0,width:this.width,outerWidth:0,innerWidth:0},this.cells=new iui.util.Collection,this.headerRenderer=a.headerRenderer||iui.sheet.renderer.ColumnHeader,this.resizable=!!a.resizable,this.renderer=a.renderer||iui.sheet.renderer.String,this.editor=a.editor,this.buttons=null},a.extend(iui.sheet.model.Column.prototype,iui.sheet.model.Entity,{setWidth:function(a){this.width=a,this.ui&&this.ui.width(a),this._parent._trigger("columnChanged")},render:function(){},refresh:function(){},offset:function(){return this.ui&&(this._offset={left:this.ui[0].offsetLeft,width:this.ui.width(),outerWidth:this.ui.outerWidth(),innerWidth:this.ui.innerWidth()}),this._offset}}),iui.sheet.model.Column.getColumnLabel=function(b){return a.map(b.toString(26).split(""),function(a,c){return a=parseInt(a,26),b>25&&0===c&&a--,String.fromCharCode(a+65)}).join("")}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{model:{}}}});var c=0;iui.sheet.model.ColumnGroup=function(a){return a=a||{},this instanceof iui.sheet.model.ColumnGroup?(this.uid=a.id||"columngroup"+c++,this.id=a.id||this.uid,this.label=a.label,this.columns=iui.util.Collection(),this.ui=null,this.renderer=a.renderer||iui.sheet.renderer.ColumnGroupHeader,void(this.editor=null)):new iui.sheet.model.ColumnGroup(a)},a.extend(iui.sheet.model.ColumnGroup.prototype,iui.sheet.model.Entity,{width:function(){var b=0,c=0,d=0,e=this._parent?a.map(this._parent._columns.toArray(),function(a){if(!a.ui)return null;var b=a.ui.parent();return b&&b.children().index(a.ui)>=0?a:null}):[];return a.each(this.columns.toArray(),function(){a.inArray(this,e)>=0&&(b+=this.offset().width,c=parseInt(this.ui.css("border-right-width")),d++)}),b+c*(d-1)}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{model:{}}}});var c=0,d=iui.sheet.model.Row=function(a){return a=a||{},this instanceof d?(this.index=c++,this.uid=a.id||"row"+c,this.id=a.id||this.uid,this.height=a.height||26,this.label=a.label,this.width=a.width||80,this.className="ui-state-default spreadsheet-row "+(a.className||""),this.ui=null,this._offset={top:0,height:this.height,outerHeight:0,innerHeight:0},this.cells=(new iui.util.Collection).addAll(a.cells||[]),this.headerRenderer=a.headerRenderer||iui.sheet.renderer.RowHeader,this.resizable=!0,this.renderer=null,this.editor=null,void(this.buttons=null)):new d(a)};a.extend(d.prototype,iui.sheet.model.Entity,{setHeight:function(a){this.height=a,this.ui&&this.ui.height(a),this._parent._trigger("rowChanged")},offset:function(){return this.ui&&(this._offset={top:this.ui[0].offsetTop,height:this.ui.height(),outerHeight:this.ui.outerHeight(),innerHeight:this.ui.innerHeight()}),this._offset}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{editor:{}}}}),iui.sheet.editor.Currency=function(){},a.extend(iui.sheet.editor.Currency.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{editor:{}}}}),iui.sheet.editor.Date=function(){},a.extend(iui.sheet.editor.Date.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{editor:{}}}}),iui.sheet.editor.Email=function(){},a.extend(iui.sheet.editor.Email.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{editor:{}}}}),iui.sheet.editor.Number=function(){},a.extend(iui.sheet.editor.Number.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{editor:{}}}}),iui.sheet.editor.String=function(){},a.extend(iui.sheet.editor.String.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Button=function(b){if(b=b||{},!(this instanceof c))return new c(b);var d=a('<input type="button" style="height:100%;width:100%;color:blue;font-weight:bolder">').attr("value",b.bottonLabel).attr("title",b.value).click(function(a){a.stopPropagation(),b.click(b.value)}).wrap("<div>").parent();return d};a.extend(c.prototype,{click:function(){}})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.ColumnGroupHeader=function(b){return b=b||{},this instanceof c?a("<span>").text(b.label):new c(b)};a.extend(c.prototype,{})}(jQuery,window),function(a,b,c){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var d=iui.sheet.renderer.ColumnHeader=function(b){if(b=b||{},!(this instanceof d))return new d(b);var e=a("<div>").css({padding:"0px",margin:"0px",height:"100%",width:"100%",border:0}).append(a("<span>").text(b.label!==c?b.label:b.visualId)).append('<div class="indicator">').removeClass("ui-corner-all");return e}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Currency=function(b){if(b=b||{},!(this instanceof c))return new c(b);var d,e=Math.floor(b.value.length/3),f="",g=0,h=3,i="￦";d=b.value.length-h,g=b.value.length;for(var j=0;e>j;j++)f=","+b.value.substring(d,g)+f,g=d,d-=h;return d+h>=0?f=b.value.substring(0,g)+f:0===e&&(f=b.value),","===f.substring(0,1)&&(f=f.substring(1,f.length)),"en"===options.regional&&(i="$"),f=i+f,a("<span>").text(f).wrap('<div style="text-align:right;">').parent().attr("title",b.value)};a.extend(c.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Date=function(b){b=b||{};var d="yyyy-MM-dd",e="";if(!(this instanceof c))return new c(b);"en"===options.regional&&(d="dd/MM/yyyy");var f=new Date(parseFloat(b.value));return e=d.replace(/(yyyy|yy|MM|dd|E|hh|mm|ss|a\/p)/gi,function(a){switch(a){case"yyyy":return f.getFullYear();case"MM":return f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1;case"yy":return f.getFullYear()%1e3;case"dd":return f.getDate()<10?"0"+f.getDate():f.getDate();case"HH":return f.getHours()<10?"0"+f.getHours():f.getHours();case"hh":return((h=f.getHours()%12)?h:12)<10?"0"+h:h;case"mm":return f.getMinutes()<10?"0"+f.getMinutes():f.getMinutes();case"ss":return f.getSeconds()<10?"0"+f.getSeconds():f.getSeconds();default:return a}}),a("<span>").text(e).wrap("<div>").parent().attr("title",b.value)};a.extend(c.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}}),iui.sheet.renderer.Email=function(){},a.extend(iui.sheet.renderer.Email.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Icon=function(b){return b=b||{},this instanceof c?a('<i class="fa fa-fw">').html(b.icon).css({color:b.color}).wrap("<span>").parent().append("<span>").find("span").css({display:"inline"}).text(b.value).end().wrap("<div>").parent().attr("title",b.icon):new c(b)}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Image=function(b){if(b=b||{},!(this instanceof c))return new c(b);var d=a('<div class="spreadsheet-cell">').attr("title",b.value).addClass(b.className);if(null!=b.value){a('<img src="/src/img/'+b.value+'.jpg" />').attr("alt",b.value).appendTo(d).on("load",function(){b.rows.get(0).setHeight(this.height),b.columns.get(0).setWidth(this.width)})}return d}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Link=function(b){if(b=b||{},!(this instanceof c))return new c(b);{var d=a("<div>").attr("title",b.link);a("<a>").text(b.value).attr("title",b.link).attr("href",b.link).wrap("<span>").parent().appendTo(d)}return d}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Number=function(b){return b=b||{},this instanceof c?(isNaN(b.value)||(b.value=b.value.split(/(?=(?:\d{3})+(?:\.|$))/g).join(",")),a("<span>").text(b.value).wrap('<div class="spreadsheet-cell">').parent().attr("title",b.value).addClass(b.className)):new c(b)}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.RowHeader=function(b){var c=a("<span>").text(b.label||b.index+1).wrap("<div>").parent().css({border:"0px",margin:"0px",padding:"0px",width:"100%",height:"100%"}).append('<div class="indicator">');return c};a.extend(c.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.String=function(b){if(b=b||{},!(this instanceof c))return new c(b);{var d=a("<div>").attr("title",b.value);a("<span>").text(b.value).appendTo(d)}return d}}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{renderer:{}}}});var c=iui.sheet.renderer.Title=function(b){return b=b||{},this instanceof c?a('<div style="text-align:center;color:red;font-weight:bolder">').text(b.value).wrap('<div class="spreadsheet-cell">').parent().attr("title",b.value).addClass(b.className):new c(b)};a.extend(c.prototype,{})}(jQuery,window),function(a,b){a.extend(!0,b,{iui:{sheet:{plugin:{}}}}),iui.sheet.plugin.Pagenation=function(){},a.extend(iui.sheet.plugin.Pagenation.prototype,{})}(jQuery,window),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function b(b){return Math.round(b.offsetLeft+b.offsetWidth)-parseInt(a(b).css("border-right-width")||1)}function c(b){return Math.round(b.offsetTop+b.offsetHeight)-parseInt(a(b).css("border-bottom-width")||1)}var d=0,e=iui.util.Collection,f=(iui.util.Iterator,iui.util.Base64,iui.util.Circuit,iui.sheet.model.Cell),g=iui.sheet.model.Column,h=iui.sheet.model.ColumnGroup,i=iui.sheet.model.Row,j=(iui.sheet.renderer.ColumnGroupHeader,iui.util.fnv32a),k=iui.util.laptime;return k("위젯 시작"),a.widget("iui.january",{version:"0.3.929-SNAPSHOT",options:{height:"auto",width:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,title:"Innerwave January is jQuery plugin for datagrid.",showTitle:!0,showColumnGroups:!1,columns:[],defaultColumnWidth:50,showColumnHeaders:!1,showRowHeaders:!1,defaultRowHeight:24,data:[],dataParseUnit:10,showDefaultGrid:!0,defaultGridLineColor:"#CCC",showValueWindow:!1,numberOfFixedRows:0,numberOfFixedColumns:0,ready:a.noop,update:a.noop,valueWindow:null,progressBar:null},_create:function(){this.uid=this.options.id||"sheet"+d++,this.id=this.options.id||this.uid,this.className="sheet",this.parent=null,this.original={css:{display:this.element[0].style.display,width:this.element[0].style.width,minWidth:this.element[0].style.minWidth,maxWidth:this.element[0].style.maxWidth,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},contents:this.element[0].innerHTML},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this.element.attr("title",""),this.boundary={firstRow:0,numberOfRows:50,firstColumn:0,numberOfColumns:50},this._scrolling=!1,this.cancleParseData=!1,this._columns=e(),this._columnGroups=e(),this.dataProvider=e(),this._rows=e(),this._cells=e(),this.addColumns(this.options.columns),this._render(),k(" _create end")},_setOption:function(a,b){return"columns"===a?this.columns(b):"data"===a&&this.data(b),this._super(a,b),this},destroy:function(){this._super()},disable:function(){this._super()},enable:function(){this._super()},instance:function(){this._super()},columns:function(a){return void 0===a?this._columns.toArray():(this._columns.empty(),void this.addColumns(a))},rows:function(a){return void 0===a?this._rows.toArray():(this._rows.empty(),void this.addRows(a))},data:function(a){return void 0===a?this.dataProvider.toArray():(this.dataProvider.empty(),this.dataProvider.addAll(a),this.cancleParseData=!1,this.initialized&&this._trigger("dataChanged"),void k(" .set data into dataprovider >"))},addColumn:function(a){k("addColumn start");var b=g(a);b.parent(this),this._columns.add(b);var c=this._columnGroups.getById(j(a.group||b.id));return c||(c=h({id:j(a.group||b.id),label:a.group||""}),c.parent(this),this._columnGroups.add(c)),c.columns.add(b),b},addColumns:function(a){k("addColumns start");for(var b=[],c=0,d=a.length;d>c;c++)a[c].visualId=g.getColumnLabel(c),b[b.length]=this.addColumn(a[c]);return b},addRow:function(a){k("addRow start");var b=i(a);return b.parent(this),this._rows.add(b),b},addRows:function(a){k("addRows start");for(var b=[],c=0,d=a.length;d>c;c++)b.push(this.addRow(a[c]));return b},addCell:function(a){var b=f(a);return b.parent(this),this._cells.add(b),b},addCells:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(this.addCell(a[c]));return b},_render:function(){var b=this;this.element.show(),this.element.width("auto"===this.options.width||"100%"===this.options.width?Math.max(this.original.css.minWidth,this.original.css.width||this.element.attr("width")):this.options.width),this.element.height("auto"===this.options.height||"100%"===this.options.height?Math.max(this.original.css.minHeight,this.original.css.height||this.element.attr("height")):this.options.height),this.element.addClass("spreadsheet ui-widget ui-state-default"),this._showProgressBar(),this.$uiContainer=a("<div class='spreadsheet-container'>").width(this.element.width()).height(this.element.height()).appendTo(this.element),this.$uiHeader=a("<div class='spreadsheet-header ui-state-default'>").appendTo(this.$uiContainer),this.$uiViewport=a("<div class='spreadsheet-viewport ui-widget-content'>").appendTo(this.$uiContainer),this.$defaultGrid=a("<canvas class='spreadsheet-gridlines'>").appendTo(this.$uiViewport),this.$uiColumnViewport=a("<div class='spreadsheet-viewport-column ui-state-default'>").appendTo(this.$uiContainer),this.$uiColumns=a("<ul class='spreadsheet-column-list'>").sortable({zIndex:9999,placeholder:"ui-state-highlight spreadsheet-placeholder-column",start:function(c,d){var e=b.$uiColumns.children(),f=e.index(d.item[0]);a(d.item[0]).data("originalIndex",f)},stop:function(c,d){var e=a(d.item[0]).data("originalIndex"),f=b.$uiColumns.children(),g=f.index(d.item[0]);b._columns.move(d.item[0].id,g-e),b._trigger("columnChanged")}}).disableSelection().appendTo(this.$uiColumnViewport),this.$uiRowViewport=a("<div class='spreadsheet-viewport-row ui-state-default'>").appendTo(this.$uiContainer),this.$uiRows=a("<ul class='spreadsheet-row-list'>").sortable({placeholder:"ui-state-highlight spreadsheet-placeholder-row",start:function(c,d){var e=b.$uiRows.children(),f=e.index(d.item[0]);a(d.item[0]).data("originalIndex",f)},stop:function(c,d){var e=a(d.item[0]).data("originalIndex"),f=b.$uiRows.children(),g=f.index(d.item[0]);b._rows.move(d.item[0].id,g-e),b._trigger("rowChanged")}}).disableSelection().appendTo(this.$uiRowViewport),this.$uiColumnViewport.css("margin-left",this.$uiRowViewport.outerWidth()+"px"),this._renderTitleBar(),this._renderColumns(),this._renderRows(),this._createValueWindow(),this.$uiViewport.width(this.$uiContainer.width()-this.$uiRowViewport.outerWidth()).height(this.$uiContainer.height()-this.$uiHeader.outerHeight()-this.$uiColumnViewport.outerHeight()),this.$uiFooter=a("<div class='spreadsheet-footer ui-state-default'>").appendTo(this.$uiContainer),this.$uiVerticalScrollArea=a("<div class='spreadsheet-scrollbar scroll-area-vertical'>").appendTo(this.$uiContainer),this.$uiHorizontalScrollArea=a("<div class='spreadsheet-scrollbar scroll-area-horizontal'>").appendTo(this.$uiFooter),this._setupEvents(),this._trigger("initialized")},_parseEachData:function(b,c){var d,e,f,g,h,i={},j=this;a.each(b,function(b){if("id"===b||"uid"===b||"uid"===b||"height"===b||"width"===b)return void(c.key=this);if(i="string"==typeof this?{value:this}:this,e=j.addCell(i),c.cells.add(e),e.rows.add(c),i.rows)for(f=0,g=i.rows.length;g>f;f++)h=j._rows.getById(i.rows[f]),h&&a.inArray(e.rows.toArray(),h)<0&&e.rows.add(h);if(d=j._columns.getById(b),d.cells.add(e),i.columns)for(f=0,g=i.columns.length;g>f;f++)h=j._columns.getById(i.columns[f]),h&&a.inArray(e.columns.toArray(),h)<0&&e.columns.add(h);e.columns.add(d)})},_parseData:function(){if(this.initialized&&!this.cancleParseData){var a,b,c=0,d=this.dataProvider.length;this._rows.empty(),this._cells.empty();var e=this.dataProvider.toArray(),f=[],g=this.options.dataParseUnit,h=0,i=0;for(c=0,d=e.length;d>c;c+=g)f.push(e.slice(c,Math.min(c+g,d)));var j=function(g){for(c=0,d=g.length;d>c;c++)b=g[c],a=this.addRow(b),this._parseEachData(b,a);if(h+=c,void 0!==this.$uiProgressBar.progressbar("instance")&&this.$uiProgressBar.progressbar("value",parseInt(h/e.length*100)),this._delay(function(){this._trigger("rowChanged")},10),i>=f.length-1);else{if(this.cancleParseData)return;this._delay(function(){j.call(this,f[++i])},30)}};f.length>0&&j.call(this,f[i])}},stopParseData:function(){this.cancleParseData=!0,this._hideProgressBar("slow")},_hideProgressBar:function(a){this.$uiProgressBar&&this.$uiProgressBar.hide(a)},_showProgressBar:function(){var b=this;this.$uiProgressBar?this.$uiProgressBar.show():this.options.progressBar?this.$uiProgressBar=this.options.progressBar.appendTo(this.element).show():(this.$uiProgressLabel=a('<div class="spreadsheet-progress-label">').text("Loading......"),this.$uiProgressBar=a('<div class="spreadsheet-progress">').progressbar({value:!1,change:function(){b.$uiProgressLabel.text(b.$uiProgressBar.progressbar("value")+"% ").css("left",(b.$uiProgressBar.width()-b.$uiProgressLabel.outerWidth())/2+"px")},complete:function(){b.$uiProgressLabel.text("100%"),b.$uiProgressLabel.css("left",(b.$uiProgressBar.width()-b.$uiProgressLabel.outerWidth())/2+"px"),b.$uiProgressBar.hide("slow")}}).append(this.$uiProgressLabel).appendTo(this.element)),this.$uiProgressBar.attr("title","STOP! Click to stop the data is parsed.").off("click").click(function(){b.stopParseData()}).css({top:(this.element.height()-this.$uiProgressBar.outerHeight())/2+"px",left:(this.element.width()-this.$uiProgressBar.outerWidth())/2+"px"})},_renderTitleBar:function(){this.options.showTitle===!0?this.$uiTitle=a('<span class="spreadsheet-title">').text(this.options.title).appendTo(this.$uiHeader):this.$uiHeader.remove()},_createValueWindow:function(){this.options.showValueWindow===!0&&(this.$uiValueWindow=a('<div class="spreadsheet-value-window ui-widget">').append('<span class="value-editor-label">Value: </span>').append('<input type="text" class="ui-widget ui-widget-content"/>').prependTo(this.$uiColumnViewport))},_createUiColumnGroup:function(b){var c=b.renderer(b);return b.ui=a('<li class="spreadsheet-column spreadsheet-column-group ui-state-default">').append(c)},_createUiColumn:function(b){var c=this,d=b.headerRenderer(b);return b.ui=a("<li>").attr("id",b.uid).addClass(b.className).width(b.offset().width).button().append(d),b.resizable&&b.ui.resizable({handles:"e",minWidth:2,start:function(){},stop:function(a,d){b.width=d.size.width,b.ui.width(b.width),c._renderColumns(c.boundary.firstColumn)}}),b.ui.on("click",function(a){a.ctrlKey===!1&&(c._cells.each("removeClass",["ui-state-highlight"]),c._columns.each("removeClass",["ui-state-highlight"]),c._rows.each("removeClass",["ui-state-highlight"])),b.addClass("ui-state-highlight"),b.cells.each("addClass",["ui-state-highlight"])}).mousedown(function(){var b=[],d=c._columns.getById(this.id);if(d.group){var e=c._columnGroups.getById(j(d.group));b=a.map(e.columns.toArray(),function(a){return a.ui})}else b=c.$uiColumns.children().map(function(){return d=c._columns.getById(this.id),d.group?null:this});c.$uiColumns.sortable("option","items",b)}),b.ui},__renderColumns:function(b){function c(){for(var a;i>g&&l<this.$uiViewport.width();g++)d=this._columns.get(g),d.removeClass("ui-state-hover"),e=(d.ui||this._createUiColumn(d)).appendTo(this.$uiColumns),e.removeClass().addClass(d.className),l+=d.offset().outerWidth,this.options.showColumnGroups&&(a=j(d.group||d.id),f=this._columnGroups.getById(a),f||(f=new h({id:a,label:d.group}),f.parent(this),f.columns.add(d),this._columnGroups.add(f)),k.push(f))}var d,e,f,g=0,i=0,k=[],l=0;if(this.$uiColumns.children().detach(),this.options.numberOfFixedColumns>0&&(g=0,i=this.options.numberOfFixedColumns,c.call(this)),b=Math.max(Math.min(Math.max(this.options.numberOfFixedColumns,b||0),this._columns.length-1),0),this.boundary.firstColumn=b,g=b,i=Math.min(b+this.boundary.numberOfColumns,this._columns.length),c.call(this),this.options.showColumnGroups===!1)this.$uiColumnGroups&&this.$uiColumnGroups.hide();else for(this.$uiColumnGroups=this.$uiColumnGroups||a('<ul class="spreadsheet-column-group-list">').disableSelection().insertBefore(this.$uiColumns),this.$uiColumnGroups.children().each(function(){a(this).detach()}),g=0,i=k.length;i>g;g++)f=k[g],this.$uiColumnGroups.append((f.ui||this._createUiColumnGroup(f)).width(f.width()));this.options.showColumnHeaders===!1?(this.$uiColumnGroups&&this.$uiColumnGroups.hide(),this.$uiColumns.addClass("hidden")):(this.$uiColumnGroups&&this.$uiColumnGroups.show(),this.$uiColumns.removeClass("hidden")),this.$uiViewport.width(this.$uiContainer.width()-this.$uiRowViewport.outerWidth()).height(this.$uiContainer.height()-this.$uiHeader.outerHeight()-this.$uiColumnViewport.outerHeight()),this._renderData()},_renderColumns:function(){var a={};return function(b){clearTimeout(a[this.uid]),a[this.uid]=this._delay(function(){this.__renderColumns(b)},30)}}(),_onRowResize:function(a,b){b.height=a.size.height,b.ui.height(a.size.height),this._renderRows(this.boundary.firstRow)},_createUiRow:function(b){var c=this;return b.ui=a("<li>").attr("id",b.uid).addClass(b.className).height(b.height).append(b.headerRenderer(b)).button(),b.resizable&&b.ui.resizable({handles:"s",minHeight:2,stop:function(a,d){c._onRowResize(d,b)}}),b.ui.on("click",function(a){a.ctrlKey===!1&&(c._cells.each("removeClass",["ui-state-highlight"]),c._columns.each("removeClass",["ui-state-highlight"]),c._rows.each("removeClass",["ui-state-highlight"])),b.addClass("ui-state-highlight"),b.cells.each("addClass",["ui-state-highlight"])}),b.ui},__renderRows:function(a){function b(a){for(var b,g;d>c&&f>e;c++)b=this._rows.get(c),b.fixed=!!a,b.removeClass("ui-state-hover"),g=(b.ui||this._createUiRow(b)).appendTo(this.$uiRows),g.removeClass().addClass(b.className),e+=b.offset().outerHeight}var c=0,d=0,e=0,f=this.$uiViewport.height();this.$uiRows.children().detach(),this.options.numberOfFixedRows>0&&(c=0,d=this.options.numberOfFixedRows,b.call(this,!0)),a=Math.max(Math.min(Math.max(this.options.numberOfFixedRows,a||0),this._rows.length-1),0),this.boundary.firstRow=a,c=a,d=Math.min(a+this.boundary.numberOfRows,this._rows.length),b.call(this,!1),this.options.showRowHeaders===!1?(this.$uiRowViewport.addClass("hidden"),this.$uiColumnViewport.css("margin-left",this.$uiRowViewport.outerWidth()+"px")):this.$uiRowViewport.removeClass("hidden"),this.$uiViewport.width(this.$uiContainer.width()-this.$uiRowViewport.outerWidth()).height(this.$uiContainer.height()-this.$uiHeader.outerHeight()-this.$uiColumnViewport.outerHeight()),this._renderData()},_renderRows:function(){var a={};return function(b){clearTimeout(a[this.uid]),a[this.uid]=this._delay(function(){this.__renderRows(b)},10)}}(),_offsetOfCell:function(a){var b,c,d,e,f=Number.MAX_VALUE,g=Number.MAX_VALUE,h=0,i=0;for(b=0,c=a.columns.length;c>b;b++)d=a.columns.get(b),e=d.offset(),f=Math.min(f,e.left),h+=e.innerWidth;for(b=0,c=a.rows.length;c>b;b++)d=a.rows.get(b),e=d.offset(),g=Math.min(g,e.top),i+=e.innerHeight;return{left:f,top:g,width:h,height:i}},_createUiCell:function(b){var c=this;return b.ui=b.getRenderer()(b).hover(function(){c._scrolling||(b.ui.addClass("ui-state-hover"),a.each(b.columns.toArray(),function(){this.addClass("ui-state-hover")}),a.each(b.rows.toArray(),function(){this.addClass("ui-state-hover")}))},function(){b.ui.removeClass("ui-state-hover"),a.each(b.columns.toArray(),function(){this.removeClass("ui-state-hover")}),a.each(b.rows.toArray(),function(){this.removeClass("ui-state-hover")})}).on("click",function(d){this.currentCell=b,this.currentCells=this.currentCells||[],d.ctrlKey===!1&&(this.currentCells=[],c._cells.each("removeClass",["ui-state-highlight"]),c._columns.each("removeClass",["ui-state-highlight"]),c._rows.each("removeClass",["ui-state-highlight"])),this.currentCells.push(b),b.addClass("ui-state-highlight"),a.each(b.columns.toArray(),function(){this.addClass("ui-state-highlight")
}),a.each(b.rows.toArray(),function(){this.addClass("ui-state-highlight")}),c.options.showValueWindow===!0&&c.$uiValueWindow.find("input:text").val(b.value)}).disableSelection(),b.ui},_renderData:function(){var b={};return function(){clearTimeout(b[this.uid]),this._createScrollbars(),this._drawDefaultGrid(),b[this.uid]=this._delay(function(){var b,c,d,e=this.boundary.firstColumn,f=this.boundary.firstRow,g=this.$uiColumns.children().length,h=this.$uiRows.children().length,i=this.options.numberOfFixedRows,j=this.options.numberOfFixedColumns,k=this._rows.toArray(),l=this._columns.toArray(),m=k.slice(f,f+h-i).concat(k.slice(0,i)),n=l.slice(e,e+g-j).concat(l.slice(0,j)),o=a.map(m,function(b){return a.map(b.cells.toArray(),function(b){return a.map(b.columns.toArray(),function(b){return a.inArray(b,n)>=0?!0:null}).length>0?b:null})});for(this.$uiViewport.find("div.spreadsheet-cell").detach(),b=0,c=o.length;c>b;b++)d=o[b],(d.ui||this._createUiCell(d)).removeClass().addClass(d.className).css(this._offsetOfCell(d)).appendTo(this.$uiViewport)},30)}}(),_createScrollbars:function(){var b=this,c=Math.max(this.options.numberOfFixedRows,0),d=this._rows.length-1,e=Math.max(this.options.numberOfFixedColumns,0),f=this._columns.length-1;this.$uiVerticalScrollArea.height(this.$uiContainer.height()-this.$uiHeader.outerHeight()-this.$uiColumnViewport.outerHeight()-parseInt(this.$uiVerticalScrollArea.css("border-top")||1)-parseInt(this.$uiVerticalScrollArea.css("bottom")||0)),this.$uiHorizontalScrollArea.width(this.$uiContainer.width()-this.$uiRowViewport.outerWidth()-parseInt(this.$uiHorizontalScrollArea.css("border-left")||1)-parseInt(this.$uiHorizontalScrollArea.css("border-right")||1)-parseInt(this.$uiHorizontalScrollArea.css("right")||0)),this.$uiVerticalScrollbar?this.$uiVerticalScrollbar.scroller("option","min",c).scroller("option","max",d):this.$uiVerticalScrollbar=a('<div class="spreadsheet-scrollbar spreadsheet-scrollbar-vertical">').scroller({orientation:"vertical",value:c,min:c,max:d,step:1,start:function(){b._scrolling=!0},stop:function(){b._scrolling=!1},slide:function(a,c){b._renderRows(c.value)}}).appendTo(this.$uiVerticalScrollArea),this.$uiHorizontalScrollbar?this.$uiHorizontalScrollbar.scroller("option","min",e).scroller("option","max",f):this.$uiHorizontalScrollbar=a('<div class="spreadsheet-scrollbar spreadsheet-scrollbar-horizontal">').scroller({value:e,min:e,max:f,step:1,start:function(){b._scrolling=!0},stop:function(){b._scrolling=!1},slide:function(a,c){b._renderColumns(c.value)}}).appendTo(this.$uiHorizontalScrollArea)},_drawDefaultGrid:function(){if(this.$uiViewport.css({top:this.$uiRows.offset().top-this.$uiContainer.offset().top,left:this.$uiColumns.offset().left-this.$uiContainer.offset().left}),Modernizr.canvas&&this.options.showDefaultGrid){var d=0,e=0;this.$uiColumns.children().each(function(){d+=a(this).outerWidth()}),this.$uiRows.children().each(function(){e+=a(this).outerHeight()}),this.$defaultGrid.attr({width:d,height:e});var f=this.$defaultGrid[0].getContext("2d");f.fillStyle=this.options.defaultGridLineColor,this.$uiColumns.children().each(function(){f.fillRect(b(this),0,1,e)}),this.$uiRows.children().each(function(){f.fillRect(0,c(this),d,1)})}},setPlugins:function(){},open:function(){},close:function(){},_setupEvents:function(){var b=this;this._on({januarycolumnchanged:function(){k("januarycolumnchanged ............... "),this.$uiHorizontalScrollbar?(this.$uiHorizontalScrollbar.scroller("option","max",this._columns.length),this._renderColumns(this.$uiHorizontalScrollbar.scroller("value"))):this._renderColumns()},januaryrowchanged:function(){k("januaryrowchanged ............... "),this.$uiVerticalScrollbar?(this.$uiVerticalScrollbar.scroller("option","max",this._rows.length),this._renderRows(this.$uiVerticalScrollbar.scroller("value"))):this._renderRows()},januarydatachanged:function(){k("januarydatachanged ............... "),this._parseData()},januaryinitialized:function(){k("januaryinitialized ............... "),this.initialized=!0,this.dataProvider.length>0&&this._delay(this._parseData,500)}}),a.each([this.$uiColumnViewport,this.$uiHorizontalScrollArea],function(){this.mousewheel(function(a){a.preventDefault(),b._onHorizontalWheel.call(b,a.deltaY||a.deltaX)})}),a.each([this.$uiRowViewport,this.$uiVerticalScrollArea],function(){this.mousewheel(function(a){a.preventDefault(),b._onVerticalWheel.call(b,a.deltaY||a.deltaX)})}),this.$uiViewport.mousewheel(function(a){a.preventDefault(),a.shiftKey===!0?b._onHorizontalWheel.call(b,a.deltaX||a.deltaY):b._onVerticalWheel.call(b,a.deltaY)})},_onVerticalWheel:function(a){this.verticalScrollBy(a)},_onHorizontalWheel:function(a){this.horizontalScrollBy(a)},verticalScrollBy:function(a){var b=this.$uiVerticalScrollbar.scroller("value")-a;this._renderRows(b),this.$uiVerticalScrollbar.scroller("value",b)},horizontalScrollBy:function(a){var b=this.$uiHorizontalScrollbar.scroller("value")-a;this._renderColumns(b),this.$uiHorizontalScrollbar.scroller("value",b)},_startKeyNavigation:function(b,c){switch(b.keyCode){case a.ui.keyCode.HOME:return c.column=0,c.row=0,!1;case a.ui.keyCode.END:return c.column=this._columns.length-1,c.row=this._rows.length-1,!1;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:}return!0},_handleEvents:{keydown:function(b){var c,d,e,f,g=a(b.target).data("ui-sheet-cell-cursor")||{column:0,row:0};switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keyNavigating&&(this._keyNavigating=!0,cell.addClass("ui-state-active"),c=this._startKeyNavigation(b,g),c===!1))return}switch(b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+f);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-f)}},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})});
